import{b as e,Y as a,a as l,d as t,q as r,u as o,c5 as n,j as i,E as s,cN as d,cO as u,h as c,O as f,a4 as m,a5 as p,a6 as h,ah as v,a8 as b,ak as w,a9 as g,cP as y,F as k,aj as x,ai as _,am as j,al as U,cQ as z,K as C,ag as O,at as P,cR as F,aq as R}from"./index-bba07fb6.js";import{Z as M,_ as S,a as B}from"./index-dcfb1df0.js";import{_ as q}from"./modal-form-2379535a.js";import"./FullscreenOutlined-9f810a90.js";import"./Dropdown-4872ae5c.js";import"./ChevronRight-eb0f27ba.js";import"./use-theme-vars-7c6afddd.js";const E=e("form",[a("inline","\n width: 100%;\n display: inline-flex;\n align-items: flex-start;\n align-content: space-around;\n ",[e("form-item",{width:"auto",marginRight:"18px"},[l("&:last-child",{marginRight:0})])])]);var $=globalThis&&globalThis.__awaiter||function(e,a,l,t){return new(l||(l=Promise))((function(r,o){function n(e){try{s(t.next(e))}catch(a){o(a)}}function i(e){try{s(t.throw(e))}catch(a){o(a)}}function s(e){var a;e.done?r(e.value):(a=e.value,a instanceof l?a:new l((function(e){e(a)}))).then(n,i)}s((t=t.apply(e,a||[])).next())}))};const L=t({name:"Form",props:Object.assign(Object.assign({},o.props),{inline:Boolean,labelWidth:[Number,String],labelAlign:String,labelPlacement:{type:String,default:"top"},model:{type:Object,default:()=>{}},rules:Object,disabled:Boolean,size:String,showRequireMark:{type:Boolean,default:void 0},requireMarkPlacement:String,showFeedback:{type:Boolean,default:!0},onSubmit:{type:Function,default:e=>{e.preventDefault()}},showLabel:{type:Boolean,default:void 0},validateMessages:Object}),setup(e){const{mergedClsPrefixRef:a}=r(e);o("Form","-form",E,n,e,a);const l={},t=i(void 0);s(d,{props:e,maxChildLabelWidthRef:t,deriveMaxChildLabelWidth:e=>{const a=t.value;(void 0===a||e>=a)&&(t.value=e)}}),s(u,{formItems:l});const c={validate:function(e,a=(()=>!0)){return $(this,void 0,void 0,(function*(){yield new Promise(((t,r)=>{const o=[];for(const e of f(l)){const t=l[e];for(const e of t)e.path&&o.push(e.internalValidate(null,a))}Promise.all(o).then((a=>{if(a.some((e=>!e.valid))){const l=a.filter((e=>e.errors)).map((e=>e.errors));e&&e(l),r(l)}else e&&e(),t()}))}))}))},restoreValidation:function(){for(const e of f(l)){const a=l[e];for(const e of a)e.restoreValidation()}}};return Object.assign(c,{mergedClsPrefix:a})},render(){const{mergedClsPrefix:e}=this;return c("form",{class:[`${e}-form`,this.inline&&`${e}-form--inline`],onSubmit:this.onSubmit},this.$slots)}}),A={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},D=[h("g",{fill:"none"},[h("path",{d:"M3.26 11.602C3.942 8.327 6.793 6 10 6c3.206 0 6.057 2.327 6.74 5.602a.5.5 0 0 0 .98-.204C16.943 7.673 13.693 5 10 5c-3.693 0-6.943 2.673-7.72 6.398a.5.5 0 0 0 .98.204zM10 8a3.5 3.5 0 1 0 0 7a3.5 3.5 0 0 0 0-7zm-2.5 3.5a2.5 2.5 0 1 1 5 0a2.5 2.5 0 0 1-5 0z",fill:"currentColor"})],-1)],I=t({name:"Eye20Regular",render:function(e,a){return m(),p("svg",A,D)}}),K={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},N=[h("g",{fill:"none"},[h("path",{d:"M2.854 2.146a.5.5 0 1 0-.708.708l3.5 3.498a8.097 8.097 0 0 0-3.366 5.046a.5.5 0 1 0 .979.204a7.09 7.09 0 0 1 3.108-4.528L7.95 8.656a3.5 3.5 0 1 0 4.884 4.884l4.313 4.314a.5.5 0 0 0 .708-.708l-15-15zm7.27 5.857l3.363 3.363a3.5 3.5 0 0 0-3.363-3.363zM7.53 5.41l.803.803A6.632 6.632 0 0 1 10 6c3.206 0 6.057 2.327 6.74 5.602a.5.5 0 1 0 .98-.204C16.943 7.673 13.693 5 10 5c-.855 0-1.687.143-2.469.41z",fill:"currentColor"})],-1)],V=t({name:"EyeOff20Filled",render:function(e,a){return m(),p("svg",K,N)}}),W=t({name:"table-link"}),T=t({...W,setup(e){const a=[{title:"id",key:"id",width:50},{title:"小说名",key:"title"},{title:"章节数",key:"chapter",render:e=>e.chapter?`${e.chapter}章`:"无"},{title:"读完",key:"duwan",render:e=>0==e.duwan?c(z,{bordered:!1,type:"success"},{default:()=>"读完"}):c(z,{bordered:!1,type:"warning"},{default:()=>"未读完"})},{title:"推荐/小说",key:"recommended",render(e){let a="小说";return 1==e.recommended&&(a="推荐"),c(z,{bordered:!1,type:"info"},{default:()=>a})}},{title:"删除状态",key:"isdel",render:e=>0===e.isdel?c(z,{bordered:!1,type:"error"},{default:()=>"删除",icon:()=>c(V)}):c(z,{bordered:!1,type:"success"},{default:()=>"存在",icon:()=>c(I)})},{title:"首页链接",key:"url",render:e=>c(C,{strong:!0,tertiary:!0,size:"small",onClick:()=>{}},{default:()=>e.url&&""!==e.url?"复制":"无"})},{title:"章节链接",key:"chapterUrl",render:e=>c(C,{strong:!0,tertiary:!0,size:"small",onClick:()=>{}},{default:()=>e.chapterUrl&&""!==e.chapterUrl?"复制":"无"})},{title:"备注",key:"beizhu",ellipsis:{tooltip:!0}}],l=[{value:0,label:"未读完"},{value:1,label:"读完"}],t=[{value:0,label:"小说"},{value:1,label:"推荐"}],r={title:{trigger:"blur",required:!0,validator:(e,a)=>""===a?new Error("不能为空"):!s||!o.data.some((e=>e.title===a))||new Error("小说名不能相同")}},o=v({data:[],form:{title:"",chapter:"",duwan:0,recommended:0,url:"",chapterUrl:"",beizhu:""},show:!1}),n=async()=>{try{const{data:e}=await O.get("/crud/select/novel");o.data=e.reverse()}catch(e){}};n();let s=!0;const d=i(),u=()=>{o.form={title:"",chapter:"",duwan:0,recommended:0,url:"",chapterUrl:"",beizhu:""},s=!0,o.show=!0},f=e=>{s=!1,o.form=e,o.show=!0},h=()=>{d.value.validate((async e=>{try{if(!e){let e=s?"/crud/insert/novel":"/crud/update/novel",a=o.form;if(s||(a.where={title:o.form.title}),await O.post(e,o.form),s){const e=await O.get("/desc-limit/novel");o.data.unshift(...e.data.data),o.form={title:"",chapter:"",duwan:0,recommended:0,url:"",chapterUrl:"",beizhu:""}}window.$message.success("操作成功")}}catch(a){}}))},E=async(e,a)=>{await O.post("/crud/update/novel",{where:{title:e.title},isdel:!e.isdel}).catch((e=>Promise.reject(e))),o.data[a].isdel=Number(!e.isdel)};return(e,i)=>{const s=P,c=F,v=S,z=R,C=B,O=L;return m(),p("div",null,[b(w(M),{columns:a,data:w(o).data,"checkbox-key":"id",onAdd:u,onFlushed:n,onDelItem:E,onUpdateItem:f},null,8,["data"]),b(q,{show:w(o).show,"onUpdate:show":i[7]||(i[7]=e=>w(o).show=e),onConfirmForm:h},{default:g((()=>[b(O,{ref_key:"formRef",ref:d,"label-placement":"left","label-width":"100","label-align":"left",model:w(o).form,rules:r,onKeyup:y(h,["enter"])},{default:g((()=>[b(c,{label:"小说名:",path:"title"},{default:g((()=>[b(s,{placeholder:"小说名",clearable:"",value:w(o).form.title,"onUpdate:value":i[0]||(i[0]=e=>w(o).form.title=e)},null,8,["value"])])),_:1}),b(c,{label:"章节数："},{default:g((()=>[b(s,{placeholder:"章节数",clearable:"",value:w(o).form.chapter,"onUpdate:value":i[1]||(i[1]=e=>w(o).form.chapter=e)},null,8,["value"])])),_:1}),b(c,{label:"读完："},{default:g((()=>[b(C,{value:w(o).form.duwan,"onUpdate:value":i[2]||(i[2]=e=>w(o).form.duwan=e),name:"radiogroup"},{default:g((()=>[b(z,null,{default:g((()=>[(m(!0),p(k,null,x(l,(e=>(m(),_(v,{key:e.value,value:e.value},{default:g((()=>[j(U(e.label),1)])),_:2},1032,["value"])))),128))])),_:1})])),_:1},8,["value"])])),_:1}),b(c,{label:"推荐/小说："},{default:g((()=>[b(C,{value:w(o).form.recommended,"onUpdate:value":i[3]||(i[3]=e=>w(o).form.recommended=e),name:"radiogroup"},{default:g((()=>[b(z,null,{default:g((()=>[(m(!0),p(k,null,x(t,(e=>(m(),_(v,{key:e.value,value:e.value},{default:g((()=>[j(U(e.label),1)])),_:2},1032,["value"])))),128))])),_:1})])),_:1},8,["value"])])),_:1}),b(c,{label:"首页链接："},{default:g((()=>[b(s,{placeholder:"首页链接",clearable:"",value:w(o).form.url,"onUpdate:value":i[4]||(i[4]=e=>w(o).form.url=e)},null,8,["value"])])),_:1}),b(c,{label:"章节链接："},{default:g((()=>[b(s,{placeholder:"章节链接",clearable:"",value:w(o).form.chapterUrl,"onUpdate:value":i[5]||(i[5]=e=>w(o).form.chapterUrl=e)},null,8,["value"])])),_:1}),b(c,{label:"备注："},{default:g((()=>[b(s,{placeholder:"备注",type:"textarea",clearable:"",value:w(o).form.beizhu,"onUpdate:value":i[6]||(i[6]=e=>w(o).form.beizhu=e)},null,8,["value"])])),_:1})])),_:1},8,["model","onKeyup"])])),_:1},8,["show"])])}}});export{T as default};
