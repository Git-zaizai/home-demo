import{d as e,a4 as t,a5 as n,a6 as r,p as i,j as o,a7 as l,a8 as a,al as s,aL as c,A as u,an as f,ac as h,ad as p}from"./index-6d977a42.js";import{u as d}from"./use-theme-vars-a2d680f7.js";const v={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},w=[r("path",{d:"M80 152v256a40.12 40.12 0 0 0 40 40h272a40.12 40.12 0 0 0 40-40V152",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),r("rect",{x:"48",y:"64",width:"416",height:"80",rx:"28",ry:"28",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 304l-64 64l-64-64"},null,-1),r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 345.89V224"},null,-1)],y=e({name:"ArchiveOutline",render:function(e,r){return t(),n("svg",v,w)}});async function m(e){try{return await new Promise(((t,n)=>e.file(t,n)))}catch(t){throw Error(`${e.name} 转格式为 file对象 失败! ${t}`)}}function k(e){return new Promise((t=>{e.createReader().readEntries((e=>{t(e)}),(e=>{throw Error(`获取目录信息失败！错误: ${JSON.stringify(e)}`)}))}))}async function g(e){const t=[];for(const n of e)if(n.isDirectory){const e=await k(n);if(0===e.length)continue;const r=await g(e);t.push(...r)}else t.push(n);return t}async function C(e){return async function(e){const t=[];for(const n of e){const e=await m(n);t.push({file:e,path:n.fullPath.replace("/","")})}return t}(await g(Array.from(e).map((e=>e.webkitGetAsEntry()))))}function x(e,t,n,r){return e===t-1?{name:n,path:r,isfile:!0}:{name:n,path:r,isfile:!1,children:[]}}function b(e,t){let n=e.children,r=t.split("/");for(let i=1,o=r.length;i<o;i++){const e=n.find((e=>e.name===r[i]));if(e)n=e.children;else{const e=x(i,r.length,r[i],r.slice(0,i+1).join("/"));n.push(e),n=e.children}}}function A(e){var t,n;const r=e.map((e=>"path"in e?e:{file:e,path:e.webkitRelativePath})),i=r[0].path.split("/").shift(),o={name:i,path:i,isfile:!1,children:[]};for(let l=0,a=e.length;l<a;l++){const e=r[l].path.split("/");e.length<=2?void 0===r[l].file?null==(t=o.children)||t.push({name:e.at(-1),path:r[l].path,isfile:!0}):null==(n=o.children)||n.push({name:r[l].file.name,path:r[l].path,isfile:!0}):b(o,r[l].path)}return o}const j=e({name:"inputFile",components:{ArchiveOutline:y},props:{webkitdirectory:{type:Boolean,default:!1},title:{type:String,default:"请不要上传敏感数据，比如你的银行卡号和密码，信用卡号有效期和安全码"}},emits:["FileChange"],setup(e,{emit:t}){const n=i((()=>{const e=d();return{"--n-color":e.value.actionColor,"--text-Color":e.value.textColor3,"--border-radius":e.value.borderRadius,"--primary-color-hover":e.value.primaryColorHover}})),r=o();return{ArchiveOutline:y,fileStyles:n,fileDivOndrop:async function(e){var n;try{const r=null==(n=e.dataTransfer)?void 0:n.items,i=await async function(e){const t=await C(e);return 0===t.length?{filesArray:[],DirectoryTree:{}}:{filesArray:t,DirectoryTree:A(t)}}(r);t("FileChange",i)}catch(r){window.$notification.error({content:r.toString(),title:"错误：",duration:2500,keepAliveOnHover:!0})}},inputFileChange:function(n){let i=Array.from(n.target.files);const o=e.webkitdirectory?A(i):{};t("FileChange",{filesArray:i.map((e=>({file:e,path:e.webkitRelativePath}))),DirectoryTree:o}),r.value.value=null},inputFileRef:r}}}),D=["webkitdirectory"],F=(e=>(h("data-v-0a4c6584"),e=e(),p(),e))((()=>r("h2",{class:"file-text"},"点击或者拖动文件到该区域来上传",-1))),O={class:"file-text"};const R=l(j,[["render",function(e,i,o,l,h,p){const d=f;return t(),n("label",{style:u(e.fileStyles)},[r("input",{id:"file_webky",ref:"inputFileRef",type:"file",multiple:"",webkitdirectory:e.webkitdirectory,onChange:i[0]||(i[0]=(...t)=>e.inputFileChange&&e.inputFileChange(...t))},null,40,D),r("div",{class:"file-div view-curspointer flex-fdc-alc-juc",onDrop:i[1]||(i[1]=c(((...t)=>e.fileDivOndrop&&e.fileDivOndrop(...t)),["prevent"])),onDragover:i[2]||(i[2]=c((()=>!1),["prevent"]))},[a(d,{size:"100",color:"var(--text-Color)",component:e.ArchiveOutline},null,8,["component"]),F,r("h4",O,s(e.title),1)],32)],4)}],["__scopeId","data-v-0a4c6584"]]);export{R as I};
